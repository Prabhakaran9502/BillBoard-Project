{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport LRUCache from 'lru-cache';\nimport { getRealGridData } from '../services/real-data-service';\nimport { getCommodityColumns } from '../columns/commodities.columns';\nimport { getEmployeeColumns } from '../columns/employees.columns';\nimport asyncWorker from '../services/asyncWorker';\nimport { addTreeDataOptionsToDemoData } from '../services/tree-data-generator';\nconst dataCache = new LRUCache({\n  max: 10,\n  ttl: 60 * 5 * 1e3 // 5 minutes\n\n}); // Generate fake data from a seed.\n// It's about x20 faster than getRealData.\n\nasync function extrapolateSeed(rowLength, data) {\n  return new Promise(resolve => {\n    const seed = data.rows;\n    const rows = data.rows.slice();\n    const tasks = {\n      current: rowLength - seed.length\n    };\n\n    function work() {\n      const row = {};\n\n      for (let j = 0; j < data.columns.length; j += 1) {\n        const column = data.columns[j];\n        const index = Math.round(Math.random() * (seed.length - 1));\n\n        if (column.field === 'id') {\n          row.id = `id-${tasks.current + seed.length}`;\n        } else {\n          row[column.field] = seed[index][column.field];\n        }\n      }\n\n      rows.push(row);\n      tasks.current -= 1;\n    }\n\n    asyncWorker({\n      work,\n      done: () => resolve(_extends({}, data, {\n        rows\n      })),\n      tasks\n    });\n  });\n}\n\nconst deepFreeze = object => {\n  // Retrieve the property names defined on object\n  const propNames = Object.getOwnPropertyNames(object); // Freeze properties before freezing self\n\n  for (const name of propNames) {\n    const value = object[name];\n\n    if (value && typeof value === 'object') {\n      deepFreeze(value);\n    }\n  }\n\n  return Object.freeze(object);\n};\n\nexport const getColumnsFromOptions = options => {\n  let columns = options.dataSet === 'Commodity' ? getCommodityColumns(options.editable) : getEmployeeColumns();\n\n  if (options.visibleFields) {\n    columns = columns.map(col => options.visibleFields?.includes(col.field) ? col : _extends({}, col, {\n      hide: true\n    }));\n  }\n\n  if (options.maxColumns) {\n    columns = columns.slice(0, options.maxColumns);\n  }\n\n  return columns;\n};\nexport const getInitialState = (options, columns) => {\n  const columnVisibilityModel = {};\n  columns.forEach(col => {\n    if (col.hide) {\n      columnVisibilityModel[col.field] = false;\n    }\n  });\n  const groupingField = options.treeData?.groupingField;\n\n  if (groupingField) {\n    columnVisibilityModel[groupingField] = false;\n  }\n\n  return {\n    columns: {\n      columnVisibilityModel\n    }\n  };\n};\nexport const useDemoData = options => {\n  const [rowLength, setRowLength] = React.useState(options.rowLength);\n  const [index, setIndex] = React.useState(0);\n  const [loading, setLoading] = React.useState(true);\n  const columns = React.useMemo(() => {\n    return getColumnsFromOptions({\n      dataSet: options.dataSet,\n      editable: options.editable,\n      maxColumns: options.maxColumns,\n      visibleFields: options.visibleFields\n    });\n  }, [options.dataSet, options.editable, options.maxColumns, options.visibleFields]);\n  const [data, setData] = React.useState(() => {\n    return addTreeDataOptionsToDemoData({\n      columns,\n      rows: [],\n      initialState: getInitialState(options, columns)\n    }, options.treeData);\n  });\n  React.useEffect(() => {\n    const cacheKey = `${options.dataSet}-${rowLength}-${index}-${options.maxColumns}`; // Cache to allow fast switch between the JavaScript and TypeScript version\n    // of the demos.\n\n    if (dataCache.has(cacheKey)) {\n      const newData = dataCache.get(cacheKey);\n      setData(newData);\n      setLoading(false);\n      return undefined;\n    }\n\n    let active = true;\n\n    (async () => {\n      setLoading(true);\n      let newData;\n\n      if (rowLength > 1000) {\n        newData = await getRealGridData(1000, columns);\n        newData = await extrapolateSeed(rowLength, newData);\n      } else {\n        newData = await getRealGridData(rowLength, columns);\n      }\n\n      if (!active) {\n        return;\n      }\n\n      newData = addTreeDataOptionsToDemoData(newData, {\n        maxDepth: options.treeData?.maxDepth,\n        groupingField: options.treeData?.groupingField,\n        averageChildren: options.treeData?.averageChildren\n      }); // It's quite slow. No need for it in production.\n\n      if (process.env.NODE_ENV !== 'production') {\n        deepFreeze(newData);\n      }\n\n      dataCache.set(cacheKey, newData);\n      setData(newData);\n      setLoading(false);\n    })();\n\n    return () => {\n      active = false;\n    };\n  }, [rowLength, options.dataSet, options.maxColumns, options.treeData?.maxDepth, options.treeData?.groupingField, options.treeData?.averageChildren, index, columns]);\n  return {\n    data,\n    loading,\n    setRowLength,\n    loadNewData: () => {\n      setIndex(oldIndex => oldIndex + 1);\n    }\n  };\n};","map":{"version":3,"names":["_extends","React","LRUCache","getRealGridData","getCommodityColumns","getEmployeeColumns","asyncWorker","addTreeDataOptionsToDemoData","dataCache","max","ttl","extrapolateSeed","rowLength","data","Promise","resolve","seed","rows","slice","tasks","current","length","work","row","j","columns","column","index","Math","round","random","field","id","push","done","deepFreeze","object","propNames","Object","getOwnPropertyNames","name","value","freeze","getColumnsFromOptions","options","dataSet","editable","visibleFields","map","col","includes","hide","maxColumns","getInitialState","columnVisibilityModel","forEach","groupingField","treeData","useDemoData","setRowLength","useState","setIndex","loading","setLoading","useMemo","setData","initialState","useEffect","cacheKey","has","newData","get","undefined","active","maxDepth","averageChildren","process","env","NODE_ENV","set","loadNewData","oldIndex"],"sources":["C:/Users/kb/node_modules/@mui/x-data-grid-generator/hooks/useDemoData.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport LRUCache from 'lru-cache';\nimport { getRealGridData } from '../services/real-data-service';\nimport { getCommodityColumns } from '../columns/commodities.columns';\nimport { getEmployeeColumns } from '../columns/employees.columns';\nimport asyncWorker from '../services/asyncWorker';\nimport { addTreeDataOptionsToDemoData } from '../services/tree-data-generator';\nconst dataCache = new LRUCache({\n  max: 10,\n  ttl: 60 * 5 * 1e3 // 5 minutes\n});\n// Generate fake data from a seed.\n// It's about x20 faster than getRealData.\nasync function extrapolateSeed(rowLength, data) {\n  return new Promise(resolve => {\n    const seed = data.rows;\n    const rows = data.rows.slice();\n    const tasks = {\n      current: rowLength - seed.length\n    };\n    function work() {\n      const row = {};\n      for (let j = 0; j < data.columns.length; j += 1) {\n        const column = data.columns[j];\n        const index = Math.round(Math.random() * (seed.length - 1));\n        if (column.field === 'id') {\n          row.id = `id-${tasks.current + seed.length}`;\n        } else {\n          row[column.field] = seed[index][column.field];\n        }\n      }\n      rows.push(row);\n      tasks.current -= 1;\n    }\n    asyncWorker({\n      work,\n      done: () => resolve(_extends({}, data, {\n        rows\n      })),\n      tasks\n    });\n  });\n}\nconst deepFreeze = object => {\n  // Retrieve the property names defined on object\n  const propNames = Object.getOwnPropertyNames(object);\n\n  // Freeze properties before freezing self\n\n  for (const name of propNames) {\n    const value = object[name];\n    if (value && typeof value === 'object') {\n      deepFreeze(value);\n    }\n  }\n  return Object.freeze(object);\n};\nexport const getColumnsFromOptions = options => {\n  let columns = options.dataSet === 'Commodity' ? getCommodityColumns(options.editable) : getEmployeeColumns();\n  if (options.visibleFields) {\n    columns = columns.map(col => options.visibleFields?.includes(col.field) ? col : _extends({}, col, {\n      hide: true\n    }));\n  }\n  if (options.maxColumns) {\n    columns = columns.slice(0, options.maxColumns);\n  }\n  return columns;\n};\nexport const getInitialState = (options, columns) => {\n  const columnVisibilityModel = {};\n  columns.forEach(col => {\n    if (col.hide) {\n      columnVisibilityModel[col.field] = false;\n    }\n  });\n  const groupingField = options.treeData?.groupingField;\n  if (groupingField) {\n    columnVisibilityModel[groupingField] = false;\n  }\n  return {\n    columns: {\n      columnVisibilityModel\n    }\n  };\n};\nexport const useDemoData = options => {\n  const [rowLength, setRowLength] = React.useState(options.rowLength);\n  const [index, setIndex] = React.useState(0);\n  const [loading, setLoading] = React.useState(true);\n  const columns = React.useMemo(() => {\n    return getColumnsFromOptions({\n      dataSet: options.dataSet,\n      editable: options.editable,\n      maxColumns: options.maxColumns,\n      visibleFields: options.visibleFields\n    });\n  }, [options.dataSet, options.editable, options.maxColumns, options.visibleFields]);\n  const [data, setData] = React.useState(() => {\n    return addTreeDataOptionsToDemoData({\n      columns,\n      rows: [],\n      initialState: getInitialState(options, columns)\n    }, options.treeData);\n  });\n  React.useEffect(() => {\n    const cacheKey = `${options.dataSet}-${rowLength}-${index}-${options.maxColumns}`;\n\n    // Cache to allow fast switch between the JavaScript and TypeScript version\n    // of the demos.\n    if (dataCache.has(cacheKey)) {\n      const newData = dataCache.get(cacheKey);\n      setData(newData);\n      setLoading(false);\n      return undefined;\n    }\n    let active = true;\n    (async () => {\n      setLoading(true);\n      let newData;\n      if (rowLength > 1000) {\n        newData = await getRealGridData(1000, columns);\n        newData = await extrapolateSeed(rowLength, newData);\n      } else {\n        newData = await getRealGridData(rowLength, columns);\n      }\n      if (!active) {\n        return;\n      }\n      newData = addTreeDataOptionsToDemoData(newData, {\n        maxDepth: options.treeData?.maxDepth,\n        groupingField: options.treeData?.groupingField,\n        averageChildren: options.treeData?.averageChildren\n      });\n\n      // It's quite slow. No need for it in production.\n      if (process.env.NODE_ENV !== 'production') {\n        deepFreeze(newData);\n      }\n      dataCache.set(cacheKey, newData);\n      setData(newData);\n      setLoading(false);\n    })();\n    return () => {\n      active = false;\n    };\n  }, [rowLength, options.dataSet, options.maxColumns, options.treeData?.maxDepth, options.treeData?.groupingField, options.treeData?.averageChildren, index, columns]);\n  return {\n    data,\n    loading,\n    setRowLength,\n    loadNewData: () => {\n      setIndex(oldIndex => oldIndex + 1);\n    }\n  };\n};"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,oCAArB;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,SAASC,eAAT,QAAgC,+BAAhC;AACA,SAASC,mBAAT,QAAoC,gCAApC;AACA,SAASC,kBAAT,QAAmC,8BAAnC;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,SAASC,4BAAT,QAA6C,iCAA7C;AACA,MAAMC,SAAS,GAAG,IAAIN,QAAJ,CAAa;EAC7BO,GAAG,EAAE,EADwB;EAE7BC,GAAG,EAAE,KAAK,CAAL,GAAS,GAFe,CAEX;;AAFW,CAAb,CAAlB,C,CAIA;AACA;;AACA,eAAeC,eAAf,CAA+BC,SAA/B,EAA0CC,IAA1C,EAAgD;EAC9C,OAAO,IAAIC,OAAJ,CAAYC,OAAO,IAAI;IAC5B,MAAMC,IAAI,GAAGH,IAAI,CAACI,IAAlB;IACA,MAAMA,IAAI,GAAGJ,IAAI,CAACI,IAAL,CAAUC,KAAV,EAAb;IACA,MAAMC,KAAK,GAAG;MACZC,OAAO,EAAER,SAAS,GAAGI,IAAI,CAACK;IADd,CAAd;;IAGA,SAASC,IAAT,GAAgB;MACd,MAAMC,GAAG,GAAG,EAAZ;;MACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGX,IAAI,CAACY,OAAL,CAAaJ,MAAjC,EAAyCG,CAAC,IAAI,CAA9C,EAAiD;QAC/C,MAAME,MAAM,GAAGb,IAAI,CAACY,OAAL,CAAaD,CAAb,CAAf;QACA,MAAMG,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiBd,IAAI,CAACK,MAAL,GAAc,CAA/B,CAAX,CAAd;;QACA,IAAIK,MAAM,CAACK,KAAP,KAAiB,IAArB,EAA2B;UACzBR,GAAG,CAACS,EAAJ,GAAU,MAAKb,KAAK,CAACC,OAAN,GAAgBJ,IAAI,CAACK,MAAO,EAA3C;QACD,CAFD,MAEO;UACLE,GAAG,CAACG,MAAM,CAACK,KAAR,CAAH,GAAoBf,IAAI,CAACW,KAAD,CAAJ,CAAYD,MAAM,CAACK,KAAnB,CAApB;QACD;MACF;;MACDd,IAAI,CAACgB,IAAL,CAAUV,GAAV;MACAJ,KAAK,CAACC,OAAN,IAAiB,CAAjB;IACD;;IACDd,WAAW,CAAC;MACVgB,IADU;MAEVY,IAAI,EAAE,MAAMnB,OAAO,CAACf,QAAQ,CAAC,EAAD,EAAKa,IAAL,EAAW;QACrCI;MADqC,CAAX,CAAT,CAFT;MAKVE;IALU,CAAD,CAAX;EAOD,CA3BM,CAAP;AA4BD;;AACD,MAAMgB,UAAU,GAAGC,MAAM,IAAI;EAC3B;EACA,MAAMC,SAAS,GAAGC,MAAM,CAACC,mBAAP,CAA2BH,MAA3B,CAAlB,CAF2B,CAI3B;;EAEA,KAAK,MAAMI,IAAX,IAAmBH,SAAnB,EAA8B;IAC5B,MAAMI,KAAK,GAAGL,MAAM,CAACI,IAAD,CAApB;;IACA,IAAIC,KAAK,IAAI,OAAOA,KAAP,KAAiB,QAA9B,EAAwC;MACtCN,UAAU,CAACM,KAAD,CAAV;IACD;EACF;;EACD,OAAOH,MAAM,CAACI,MAAP,CAAcN,MAAd,CAAP;AACD,CAbD;;AAcA,OAAO,MAAMO,qBAAqB,GAAGC,OAAO,IAAI;EAC9C,IAAInB,OAAO,GAAGmB,OAAO,CAACC,OAAR,KAAoB,WAApB,GAAkCzC,mBAAmB,CAACwC,OAAO,CAACE,QAAT,CAArD,GAA0EzC,kBAAkB,EAA1G;;EACA,IAAIuC,OAAO,CAACG,aAAZ,EAA2B;IACzBtB,OAAO,GAAGA,OAAO,CAACuB,GAAR,CAAYC,GAAG,IAAIL,OAAO,CAACG,aAAR,EAAuBG,QAAvB,CAAgCD,GAAG,CAAClB,KAApC,IAA6CkB,GAA7C,GAAmDjD,QAAQ,CAAC,EAAD,EAAKiD,GAAL,EAAU;MAChGE,IAAI,EAAE;IAD0F,CAAV,CAA9E,CAAV;EAGD;;EACD,IAAIP,OAAO,CAACQ,UAAZ,EAAwB;IACtB3B,OAAO,GAAGA,OAAO,CAACP,KAAR,CAAc,CAAd,EAAiB0B,OAAO,CAACQ,UAAzB,CAAV;EACD;;EACD,OAAO3B,OAAP;AACD,CAXM;AAYP,OAAO,MAAM4B,eAAe,GAAG,CAACT,OAAD,EAAUnB,OAAV,KAAsB;EACnD,MAAM6B,qBAAqB,GAAG,EAA9B;EACA7B,OAAO,CAAC8B,OAAR,CAAgBN,GAAG,IAAI;IACrB,IAAIA,GAAG,CAACE,IAAR,EAAc;MACZG,qBAAqB,CAACL,GAAG,CAAClB,KAAL,CAArB,GAAmC,KAAnC;IACD;EACF,CAJD;EAKA,MAAMyB,aAAa,GAAGZ,OAAO,CAACa,QAAR,EAAkBD,aAAxC;;EACA,IAAIA,aAAJ,EAAmB;IACjBF,qBAAqB,CAACE,aAAD,CAArB,GAAuC,KAAvC;EACD;;EACD,OAAO;IACL/B,OAAO,EAAE;MACP6B;IADO;EADJ,CAAP;AAKD,CAhBM;AAiBP,OAAO,MAAMI,WAAW,GAAGd,OAAO,IAAI;EACpC,MAAM,CAAChC,SAAD,EAAY+C,YAAZ,IAA4B1D,KAAK,CAAC2D,QAAN,CAAehB,OAAO,CAAChC,SAAvB,CAAlC;EACA,MAAM,CAACe,KAAD,EAAQkC,QAAR,IAAoB5D,KAAK,CAAC2D,QAAN,CAAe,CAAf,CAA1B;EACA,MAAM,CAACE,OAAD,EAAUC,UAAV,IAAwB9D,KAAK,CAAC2D,QAAN,CAAe,IAAf,CAA9B;EACA,MAAMnC,OAAO,GAAGxB,KAAK,CAAC+D,OAAN,CAAc,MAAM;IAClC,OAAOrB,qBAAqB,CAAC;MAC3BE,OAAO,EAAED,OAAO,CAACC,OADU;MAE3BC,QAAQ,EAAEF,OAAO,CAACE,QAFS;MAG3BM,UAAU,EAAER,OAAO,CAACQ,UAHO;MAI3BL,aAAa,EAAEH,OAAO,CAACG;IAJI,CAAD,CAA5B;EAMD,CAPe,EAOb,CAACH,OAAO,CAACC,OAAT,EAAkBD,OAAO,CAACE,QAA1B,EAAoCF,OAAO,CAACQ,UAA5C,EAAwDR,OAAO,CAACG,aAAhE,CAPa,CAAhB;EAQA,MAAM,CAAClC,IAAD,EAAOoD,OAAP,IAAkBhE,KAAK,CAAC2D,QAAN,CAAe,MAAM;IAC3C,OAAOrD,4BAA4B,CAAC;MAClCkB,OADkC;MAElCR,IAAI,EAAE,EAF4B;MAGlCiD,YAAY,EAAEb,eAAe,CAACT,OAAD,EAAUnB,OAAV;IAHK,CAAD,EAIhCmB,OAAO,CAACa,QAJwB,CAAnC;EAKD,CANuB,CAAxB;EAOAxD,KAAK,CAACkE,SAAN,CAAgB,MAAM;IACpB,MAAMC,QAAQ,GAAI,GAAExB,OAAO,CAACC,OAAQ,IAAGjC,SAAU,IAAGe,KAAM,IAAGiB,OAAO,CAACQ,UAAW,EAAhF,CADoB,CAGpB;IACA;;IACA,IAAI5C,SAAS,CAAC6D,GAAV,CAAcD,QAAd,CAAJ,EAA6B;MAC3B,MAAME,OAAO,GAAG9D,SAAS,CAAC+D,GAAV,CAAcH,QAAd,CAAhB;MACAH,OAAO,CAACK,OAAD,CAAP;MACAP,UAAU,CAAC,KAAD,CAAV;MACA,OAAOS,SAAP;IACD;;IACD,IAAIC,MAAM,GAAG,IAAb;;IACA,CAAC,YAAY;MACXV,UAAU,CAAC,IAAD,CAAV;MACA,IAAIO,OAAJ;;MACA,IAAI1D,SAAS,GAAG,IAAhB,EAAsB;QACpB0D,OAAO,GAAG,MAAMnE,eAAe,CAAC,IAAD,EAAOsB,OAAP,CAA/B;QACA6C,OAAO,GAAG,MAAM3D,eAAe,CAACC,SAAD,EAAY0D,OAAZ,CAA/B;MACD,CAHD,MAGO;QACLA,OAAO,GAAG,MAAMnE,eAAe,CAACS,SAAD,EAAYa,OAAZ,CAA/B;MACD;;MACD,IAAI,CAACgD,MAAL,EAAa;QACX;MACD;;MACDH,OAAO,GAAG/D,4BAA4B,CAAC+D,OAAD,EAAU;QAC9CI,QAAQ,EAAE9B,OAAO,CAACa,QAAR,EAAkBiB,QADkB;QAE9ClB,aAAa,EAAEZ,OAAO,CAACa,QAAR,EAAkBD,aAFa;QAG9CmB,eAAe,EAAE/B,OAAO,CAACa,QAAR,EAAkBkB;MAHW,CAAV,CAAtC,CAZW,CAkBX;;MACA,IAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;QACzC3C,UAAU,CAACmC,OAAD,CAAV;MACD;;MACD9D,SAAS,CAACuE,GAAV,CAAcX,QAAd,EAAwBE,OAAxB;MACAL,OAAO,CAACK,OAAD,CAAP;MACAP,UAAU,CAAC,KAAD,CAAV;IACD,CAzBD;;IA0BA,OAAO,MAAM;MACXU,MAAM,GAAG,KAAT;IACD,CAFD;EAGD,CAzCD,EAyCG,CAAC7D,SAAD,EAAYgC,OAAO,CAACC,OAApB,EAA6BD,OAAO,CAACQ,UAArC,EAAiDR,OAAO,CAACa,QAAR,EAAkBiB,QAAnE,EAA6E9B,OAAO,CAACa,QAAR,EAAkBD,aAA/F,EAA8GZ,OAAO,CAACa,QAAR,EAAkBkB,eAAhI,EAAiJhD,KAAjJ,EAAwJF,OAAxJ,CAzCH;EA0CA,OAAO;IACLZ,IADK;IAELiD,OAFK;IAGLH,YAHK;IAILqB,WAAW,EAAE,MAAM;MACjBnB,QAAQ,CAACoB,QAAQ,IAAIA,QAAQ,GAAG,CAAxB,CAAR;IACD;EANI,CAAP;AAQD,CArEM"},"metadata":{},"sourceType":"module"}